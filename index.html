<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My embedded Tableau visualization</title>
    <style>
      html, body, tableau-viz, tableau-authoring-viz, tableau-pulse {
        height: 100%;
        width: 100%;
      }
    </style>
  </head>
  <body>
    <tableau-viz
      src="https://10ay.online.tableau.com/t/forsightanalytics-c7b8da01a7/views/EmailPerformancebyCampaign/EmailPerformancebyCampaign"
      device="desktop"
      hide-tabs
      toolbar="bottom"
    >
    </tableau-viz>
    <script type="module">
      import { SheetType, TableauEventType } from 'https://10ay.online.tableau.com/javascripts/api/tableau.embedding.3.latest.js';

      (async () => {
        const viz = document.querySelector('tableau-viz, tableau-authoring-viz');

        // ✅ Manually assign a valid JWT (replace with an actual token)
        viz.token = "eyJhbGciOiJIUzI1NiIsImtpZCI6ImE5MjcwYzg4LWFhMGItNGNmOS1hZGFhLWY3MWZmYTk4NTIyYyIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJjNGQ0NTkyZi1iYmJiLTRhNjAtYjRmNS01NDZmMDdiMjljZDAiLCJleHAiOjE3NDIzNzI1NDMsImp0aSI6IjAzMmQyYmRlLTkwN2YtNDZjOS04NGRhLWU3NTcxZjJiNGUyMCIsImF1ZCI6InRhYmxlYXUiLCJzdWIiOiJmb3JzaWdodGFuYWx5dGljc0BnbWFpbC5jb20iLCJzY3AiOlsidGFibGVhdTp2aWV3czplbWJlZCJdfQ.zHMv11OPJgjNUu-RvDIO3vdbpp5AzheIiOsitImuOVk"; 

        console.log("✅ Token Assigned:", viz.token);

        // Wait for the viz to become interactive
        await new Promise((resolve, reject) => {
          viz.addEventListener(TableauEventType.FirstInteractive, () => {
            console.log('✅ Viz is interactive!');
            resolve();
          });

          viz.addEventListener(TableauEventType.VizLoadError, (error) => {
            console.error('❌ Viz Load Error:', error);
            reject(error);
          });
        });
      })();
    </script>  
  </body>
</html>
