<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tableau Embedded Dashboard</title>
    <script type="module" src="https://10ay.online.tableau.com/javascripts/api/tableau.embedding.3.latest.min.js"></script>
</head>
<body>
    <h2>Tableau Embedded Dashboard</h2>

    <tableau-viz 
        id="tableauViz"
        src="https://10ay.online.tableau.com/t/forsightanalytics-c7b8da01a7/views/EmailPerformancebyCampaign/EmailPerformancebyCampaign"
        width="1912"
        height="914"
        hide-tabs
        toolbar="bottom"
        connected-app-id="47020635-fb8d-4f18-8a48-7e8741557511">
    </tableau-viz>

    <script>
    document.addEventListener("DOMContentLoaded", function() {
        const tableauViz = document.getElementById('tableauViz');

        // âœ… Replace this with your valid JWT token
        const token = "eyJhbGciOiJIUzI1NiIsImlzcyI6ImM0ZDQ1OTJmLWJiYmItNGE2MC1iNGY1LTU0NmYwN2IyOWNkMCIsImtpZCI6ImE5MjcwYzg4LWFhMGItNGNmOS1hZGFhLWY3MWZmYTk4NTIyYyIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJjNGQ0NTkyZi1iYmJiLTRhNjAtYjRmNS01NDZmMDdiMjljZDAiLCJleHAiOjE3NDIzNDIyMTMsImp0aSI6IjY0YzM3OTVlLTg1YzctNDkyYS1iN2RmLTJlNDcxMTE5ZTAxYSIsImF1ZCI6InRhYmxlYXUiLCJzdWIiOiJmb3JzaWdodGFuYWx5dGljc0BnbWFpbC5jb20iLCJzY3AiOlsidGFibGVhdTp2aWV3czplbWJlZCIsInRhYmxlYXU6dmlld3M6ZW1iZWRfYXV0aG9yaW5nIiwidGFibGVhdTppbnNpZ2h0czplbWJlZCJdfQ.8sW0jC0CzU2WJyOBg4C3SAeGTSEsCUtV1U20ia0GLTw"; // Ensure this is a fresh, valid JWT

        // âœ… Assign the token dynamically to the component
        tableauViz.token = token;
        console.log("ðŸ”‘ JWT Assigned:", tableauViz.token);

        tableauViz.addEventListener("vizLoadError", (e) => {
            console.error("âŒ Tableau Viz Load Error:", e.detail);
        });

        tableauViz.addEventListener("firstInteractive", function() {
            console.log("âœ… Tableau Viz Loaded Successfully!");
        });

        // âœ… Debugging Step: Check if the token is applied correctly
        setTimeout(() => {
            console.log("ðŸ”Ž Current Token in DOM:", tableauViz.token);
        }, 1000);
    });
    </script>

    <style>
        iframe {
            display: block;
            border: none;
        }
        tableau-viz {
            min-height: 914px;
            width: 100%;
        }
    </style>
</body>
</html>
